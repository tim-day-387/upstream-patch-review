UPDATE ROOT IMAGE ... done
P+q6E616D65\[6n[32766;32766H[6n[!p]104[?7h[1G[0J]3008;start=09dc2d6323c841928046cdf9c8f08f4d;user=root;hostname=lustre-bot-kvm;machineid=a79734507b7a4cd085276a3f8d51378f;bootid=acea3e0ab43b4a418a995cd2337c3826;pid=1;pidfdid=2;comm=systemd;type=boot\Kernel version: 6.14.0-ktest
hook init_noop

Running tests llog-unit

========= TEST   llog-unit

/workspace/lustre-release/lustre/tests/test-framework.sh: line 6803: cd: HOME not set
cat: /etc/system-release: No such file or directory
mgs: 
MGS_OS_ID=debian
MGS_OS_VERSION_CODE=0
MGS_OS_ID_LIKE= debian
cat: /etc/system-release: No such file or directory
mds1: 
MDS1_OS_ID=debian
MDS1_OS_VERSION_CODE=0
MDS1_OS_ID_LIKE= debian
cat: /etc/system-release: No such file or directory
ost1: 
OST1_OS_VERSION_CODE=0
OST1_OS_ID=debian
OST1_OS_ID_LIKE= debian
cat: /etc/system-release: No such file or directory
client: 
CLIENT_OS_ID_LIKE= debian
CLIENT_OS_ID=debian
CLIENT_OS_VERSION_CODE=0
Loading modules from /workspace/lustre-release/lustre
detected 16 online CPUs by sysfs
MODOPTS_LIBCFS=
libcfs will create CPU partition based on online CPUs
libcfs: loading out-of-tree module taints kernel.
libcfs: HW NUMA nodes: 1, HW CPU cores: 16, npartitions: 1
Lustre: Lustre: Build Version: 2.17.50_72_g5113f1d
ptlrpc/ptlrpc options: 'lbug_on_grant_miscount=1'
LNet: Added LNI 10.0.2.15@tcp [8/256/0/180]
gss/krb5 is not supported
Lustre: Echo OBD driver; http://www.lustre.org/
quota/lquota options: 'hash_lqs_cur_bits=3'
/workspace/lustre-release/lustre/tests/test-framework.sh: line 6803: cd: HOME not set
cat: /etc/system-release: No such file or directory
cat: /etc/system-release: No such file or directory
cat: /etc/system-release: No such file or directory
cat: /etc/system-release: No such file or directory
arg[0] = /workspace/lustre-release/lustre/utils/mount.lustre
arg[1] = -v
arg[2] = lustre-wbcfs
arg[3] = /mnt/lustre-mgs
source = lustre-wbcfs (lustre-wbcfs), target = /mnt/lustre-mgs
options(0/4096) = 
Lustre is using wbcfs as backend
checking for existing Lustre data: found
OSD_WBC_TGT_TYPE=MGT
OSD_WBC_FSNAME=lustre
OSD_WBC_INDEX=0
svname -> lustre:MGS0000
OSD_WBC_MGS_NID=10.0.2.15@tcp
mounting device lustre-wbcfs at /mnt/lustre-mgs, flags=0x1000000 options=osd=osd-wbcfs,mgs,virgin,update,svname=lustre-MGS0000,device=lustre-wbcfs
Lustre: lustre-MGS0000: mounting server target with '-t lustre' deprecated, use '-t lustre_tgt'
/workspace/lustre-release/lustre/tests/test-framework.sh: line 6803: cd: HOME not set
cat: /etc/system-release: No such file or directory
cat: /etc/system-release: No such file or directory
cat: /etc/system-release: No such file or directory
cat: /etc/system-release: No such file or directory
Lustre: DEBUG MARKER: Attempt llog unit tests
Lustre: 2129:0:(llog_test.c:2611:llog_test_device_init()) Setup llog-test device over MGS device
Lustre: 2129:0:(llog_test.c:98:llog_test_1()) 1a: create a log with name: 6b7c8949
Lustre: 2129:0:(llog_test.c:115:llog_test_1()) 1b: close newly-created log
Lustre: 2129:0:(llog_test.c:146:llog_test_2()) 2a: re-open a log with name: 6b7c8949
Lustre: 2129:0:(llog_test.c:166:llog_test_2()) 2b: create a log without specified NAME & LOGID
Lustre: 2129:0:(llog_test.c:184:llog_test_2()) 2b: write 1 llog records, check llh_count
Lustre: 2129:0:(llog_test.c:197:llog_test_2()) 2c: re-open the log by LOGID and verify llh_count
Lustre: 2129:0:(llog_test.c:244:llog_test_2()) 2d: destroy this log
Lustre: 2129:0:(llog_test.c:404:llog_test_3()) 3a: write 1023 fixed-size llog records
Lustre: 2129:0:(llog_test.c:368:llog_test3_process()) test3: processing records from index 501 to the end
Lustre: 2129:0:(llog_test.c:378:llog_test3_process()) test3: total 525 records processed with 0 paddings
Lustre: 2129:0:(llog_test.c:460:llog_test_3()) 3b: write 566 variable size llog records
Lustre: 2129:0:(llog_test.c:532:llog_test_3()) 3c: write records with variable size until BITMAP_SIZE, return -ENOSPC
Lustre: 2129:0:(llog_test.c:555:llog_test_3()) 3c: wrote 63962 more records before end of llog is reached
Lustre: 2129:0:(llog_test.c:584:llog_test_4()) 4a: create a catalog log with name: 6b7c894a
Lustre: 2129:0:(llog_test.c:599:llog_test_4()) 4b: write 1 record into the catalog
Lustre: 2129:0:(llog_test.c:626:llog_test_4()) 4c: cancel 1 log record
Lustre: 2129:0:(llog_test.c:638:llog_test_4()) 4d: write 64767 more log records
Lustre: 2129:0:(llog_test.c:654:llog_test_4()) 4e: add 5 large records, one record per block
Lustre: 2129:0:(llog_test.c:674:llog_test_4()) 4f: put newly-created catalog
Lustre: 2129:0:(llog_test.c:773:llog_test_5()) 5a: re-open catalog by id
Lustre: 2129:0:(llog_test.c:786:llog_test_5()) 5b: print the catalog entries.. we expect 2
Lustre: 2136:0:(llog_test.c:703:cat_print_cb()) seeing record at index 1 - [0x1:0x3:0x0] in log [0xa:0x4:0x0]
Lustre: 2129:0:(llog_test.c:798:llog_test_5()) 5c: Cancel 64767 records, see one log zapped
Lustre: 2129:0:(llog_test.c:806:llog_test_5()) 5c: print the catalog entries.. we expect 1
Lustre: 2137:0:(llog_test.c:703:cat_print_cb()) seeing record at index 2 - [0x1:0x4:0x0] in log [0xa:0x4:0x0]
Lustre: 2137:0:(llog_test.c:703:cat_print_cb()) Skipped 1 previous similar message
Lustre: 2129:0:(llog_test.c:818:llog_test_5()) 5d: add 1 record to the log with many canceled empty pages
Lustre: 2129:0:(llog_test.c:826:llog_test_5()) 5e: print plain log entries.. expect 6
Lustre: 2129:0:(llog_test.c:838:llog_test_5()) 5f: print plain log entries reversely.. expect 6
Lustre: 2129:0:(llog_test.c:852:llog_test_5()) 5g: close re-opened catalog
Lustre: 2129:0:(llog_test.c:882:llog_test_6()) 6a: re-open log 6b7c8949 using client API
Lustre: MGS: non-config logname received: 6b7c8949
Lustre: 2129:0:(llog_test.c:914:llog_test_6()) 6b: process log 6b7c8949 using client API
llog_process_th (2138) used greatest stack depth: 26320 bytes left
Lustre: 2129:0:(llog_test.c:918:llog_test_6()) 6b: processed 63962 records
Lustre: 2129:0:(llog_test.c:925:llog_test_6()) 6c: process log 6b7c8949 reversely using client API
Lustre: 2129:0:(llog_test.c:929:llog_test_6()) 6c: processed 63962 records
Lustre: 2129:0:(llog_test.c:1077:llog_test_7()) 7a: test llog_logid_rec
Lustre: 2129:0:(llog_test.c:1088:llog_test_7()) 7b: test llog_unlink64_rec
Lustre: 2129:0:(llog_test.c:1099:llog_test_7()) 7c: test llog_setattr64_rec
Lustre: 2129:0:(llog_test.c:1110:llog_test_7()) 7d: test llog_size_change_rec
Lustre: 2129:0:(llog_test.c:1121:llog_test_7()) 7e: test llog_changelog_rec
Lustre: 2129:0:(llog_test.c:1028:llog_test_7_sub()) 7_sub: records are not aligned, written 64071 from 64767
Lustre: 2129:0:(llog_test.c:1133:llog_test_7()) 7f: test llog_changelog_user_rec2
Lustre: 2129:0:(llog_test.c:1028:llog_test_7_sub()) 7_sub: records are not aligned, written 64139 from 64767
Lustre: 2129:0:(llog_test.c:1144:llog_test_7()) 7g: test llog_gen_rec
Lustre: 2129:0:(llog_test.c:1155:llog_test_7()) 7h: test llog_setattr64_rec_v2
Lustre: 2129:0:(llog_test.c:1028:llog_test_7_sub()) 7_sub: records are not aligned, written 64071 from 64767
Lustre: 2129:0:(llog_test.c:1264:llog_test_8()) 8a: fill the first plain llog
Lustre: 2129:0:(llog_test.c:1293:llog_test_8()) 8b: first llog [0x1:0x10:0x0]
Lustre: 2129:0:(llog_test.c:1309:llog_test_8()) 8b: fill the second plain llog
Lustre: 2129:0:(llog_test.c:1333:llog_test_8()) 8b: pin llog [0x1:0x12:0x0]
Lustre: 2129:0:(llog_test.c:1336:llog_test_8()) 8b: clean first llog record in catalog
Lustre: 2129:0:(llog_test.c:1347:llog_test_8()) 8c: corrupt first chunk in the middle
Lustre: 2129:0:(llog_test.c:1350:llog_test_8()) 8c: corrupt second chunk at start
Lustre: 2129:0:(llog_test.c:1353:llog_test_8()) 8d: count survived records
Lustre: 2129:0:(llog_test.c:1383:llog_test_8()) 8d: close re-opened catalog
Lustre: 2129:0:(llog_test.c:1444:llog_test_9()) 9a: test llog_logid_rec
Lustre: 2129:0:(llog_test.c:1428:llog_test_9_sub()) 9_sub: record type 1064553b in log 0x1:0x14:0x0
Lustre: 2129:0:(llog_test.c:1455:llog_test_9()) 9b: test llog_obd_cfg_rec
Lustre: 2129:0:(llog_test.c:1466:llog_test_9()) 9c: test llog_changelog_rec
Lustre: 2129:0:(llog_test.c:1478:llog_test_9()) 9d: test llog_changelog_user_rec2
Lustre: 2129:0:(llog_test.c:1579:llog_test_10()) 10a: create a catalog log with name: 6b7c894b
Lustre: 2129:0:(llog_test.c:1609:llog_test_10()) 10b: write 64767 log records
Lustre: 2129:0:(llog_test.c:1635:llog_test_10()) 10c: write 129534 more log records
Lustre: 2129:0:(llog_test.c:1667:llog_test_10()) 10c: write 64767 more log records
Lustre: 2129:0:(llog_cat.c:80:llog_cat_new_log()) MGS: there are no more free slots in catalog 6b7c894b
LustreError: 2129:0:(llog_cat.c:583:llog_cat_add_rec()) MGS: initialization error: rc = -28
Lustre: 2129:0:(llog_test.c:1694:llog_test_10()) 10c: wrote 64011 records then 756 failed with ENOSPC
Lustre: 2129:0:(llog_test.c:1713:llog_test_10()) 10d: Cancel 64767 records, see one log zapped
Lustre: 2129:0:(llog_test.c:1727:llog_test_10()) 10d: print the catalog entries.. we expect 3
Lustre: 2149:0:(llog_test.c:703:cat_print_cb()) seeing record at index 2 - [0x1:0x19:0x0] in log [0xa:0x5:0x0]
Lustre: 2129:0:(llog_test.c:1757:llog_test_10()) 10e: write 64767 more log records
Lustre: 2129:0:(llog_cat.c:80:llog_cat_new_log()) MGS: there are no more free slots in catalog 6b7c894b
Lustre: 2129:0:(llog_cat.c:80:llog_cat_new_log()) Skipped 755 previous similar messages
LustreError: 2129:0:(llog_cat.c:583:llog_cat_add_rec()) MGS: initialization error: rc = -28
LustreError: 2129:0:(llog_cat.c:583:llog_cat_add_rec()) Skipped 755 previous similar messages
Lustre: 2129:0:(llog_test.c:1784:llog_test_10()) 10e: wrote 64578 records then 189 failed with ENOSPC
Lustre: 2129:0:(llog_test.c:1786:llog_test_10()) 10e: print the catalog entries.. we expect 4
Lustre: 2129:0:(llog_cat.c:971:llog_cat_process_or_fork()) MGS: catlog [0xa:0x5:0x0] crosses index zero
Lustre: 2129:0:(llog_test.c:703:cat_print_cb()) seeing record at index 2 - [0x1:0x19:0x0] in log [0xa:0x5:0x0]
Lustre: 2129:0:(llog_test.c:703:cat_print_cb()) Skipped 2 previous similar messages
Lustre: 2129:0:(llog_test.c:1823:llog_test_10()) 10e: catalog successfully wrap around, last_idx 1, first 1
Lustre: 2129:0:(llog_test.c:1840:llog_test_10()) 10f: Cancel 64767 records, see one log zapped
Lustre: 2129:0:(llog_test.c:1854:llog_test_10()) 10f: print the catalog entries.. we expect 3
Lustre: 2129:0:(llog_cat.c:971:llog_cat_process_or_fork()) MGS: catlog [0xa:0x5:0x0] crosses index zero
Lustre: 2129:0:(llog_cat.c:971:llog_cat_process_or_fork()) Skipped 1 previous similar message
Lustre: 2129:0:(llog_test.c:1885:llog_test_10()) 10f: write 64767 more log records
Lustre: 2129:0:(llog_cat.c:80:llog_cat_new_log()) MGS: there are no more free slots in catalog 6b7c894b
Lustre: 2129:0:(llog_cat.c:80:llog_cat_new_log()) Skipped 188 previous similar messages
LustreError: 2129:0:(llog_cat.c:583:llog_cat_add_rec()) MGS: initialization error: rc = -28
LustreError: 2129:0:(llog_cat.c:583:llog_cat_add_rec()) Skipped 188 previous similar messages
Lustre: 2129:0:(llog_test.c:1912:llog_test_10()) 10f: wrote 64578 records then 189 failed with ENOSPC
Lustre: 2129:0:(llog_test.c:1959:llog_test_10()) 10g: Cancel 64767 records, see one log zapped
Lustre: 2129:0:(llog_cat.c:971:llog_cat_process_or_fork()) MGS: catlog [0xa:0x5:0x0] crosses index zero
Lustre: 2129:0:(llog_test.c:1971:llog_test_10()) 10g: print the catalog entries.. we expect 3
Lustre: 2129:0:(llog_test.c:703:cat_print_cb()) seeing record at index 4 - [0x1:0x1b:0x0] in log [0xa:0x5:0x0]
Lustre: 2129:0:(llog_test.c:703:cat_print_cb()) Skipped 6 previous similar messages
Lustre: 2129:0:(llog_test.c:2001:llog_test_10()) 10g: Cancel 64767 records, see one log zapped
Lustre: 2129:0:(llog_test.c:2015:llog_test_10()) 10g: print the catalog entries.. we expect 2
Lustre: 2129:0:(llog_test.c:2053:llog_test_10()) 10g: Cancel 64767 records, see one log zapped
Lustre: 2129:0:(llog_test.c:2067:llog_test_10()) 10g: print the catalog entries.. we expect 1
Lustre: 2129:0:(llog_test.c:2093:llog_test_10()) 10g: llh_cat_idx has also successfully wrapped!
Lustre: 2151:0:(llog_test.c:1538:cat_check_old_cb()) seeing record at index 2 - [0x1:0x1d:0x0] in log [0xa:0x5:0x0]
Lustre: 2129:0:(llog_test.c:2117:llog_test_10()) 10h: write 64767 more log records
LustreError: 2129:0:(llog_osd.c:684:llog_osd_write_rec()) cfs_race id 1317 sleeping
LustreError: 2151:0:(llog.c:682:llog_process_thread()) cfs_fail_race id 1317 waking
LustreError: 2129:0:(llog_osd.c:684:llog_osd_write_rec()) cfs_fail_race id 1317 awake: rc=447
LustreError: 2151:0:(llog.c:682:llog_process_thread()) cfs_fail_race id 1317 waking
Lustre: 2151:0:(llog_test.c:1538:cat_check_old_cb()) seeing record at index 3 - [0x1:0x1e:0x0] in log [0xa:0x5:0x0]
LustreError: 2129:0:(llog_osd.c:684:llog_osd_write_rec()) cfs_fail_race id 1317 waking
Lustre: 2129:0:(llog_test.c:2144:llog_test_10()) 10h: wrote 64767 records then 0 failed with ENOSPC
Lustre: 2129:0:(llog_test.c:2157:llog_test_10()) 10: put newly-created catalog
Lustre: 2129:0:(llog_test.c:2187:llog_test_11()) 11: create a plain nameless log
Lustre: 2129:0:(llog_test.c:2212:llog_test_11()) 11: size 8216 in 0 blocks after 1 rec
Lustre: 2129:0:(llog_test.c:2214:llog_test_11()) 11: add few records
Lustre: 2129:0:(llog_test.c:2231:llog_test_11()) 11: size 10616 in 0 blocks with few recs
lctl (2129): drop_caches: 3
Lustre: 2129:0:(llog_test.c:2256:llog_test_11()) 11: re-open the log by LOGID and verify llh_count
Lustre: 2129:0:(llog_test.c:2271:llog_test_11()) 11: size 10616 in 0 blocks after re-open
Lustre: 2129:0:(llog_test.c:2338:llog_test_12()) 12a: create a catalog log with name: 6b7c894c
Lustre: 2129:0:(llog_test.c:2354:llog_test_12()) 12b: write 1 record into the catalog
LustreError: 2129:0:(llog_test.c:2365:llog_test_12()) 12b: found 7 plain llogs
Lustre: 2129:0:(llog_test.c:2367:llog_test_12()) 12c: erase plain llog
Lustre: 2129:0:(llog_test.c:2387:llog_test_12()) 12d: forward process: found=2048 rc=0
LustreError: 2129:0:(osd_object.c:152:osd_object_release()) lustre-MGS0000: Object [0x1:0x24:0x0] wrong: 0 inode@00000000ec23953b nlink=0
LustreError: 2129:0:(osd_object.c:155:osd_object_release()) ASSERTION( !(o->oo_destroyed == 0 && o->oo_inode && o->oo_inode->i_nlink == 0) ) failed: 
LustreError: 2129:0:(osd_object.c:155:osd_object_release()) LBUG
CPU: 13 UID: 0 PID: 2129 Comm: lctl Tainted: G           O       6.14.0-ktest #1
Tainted: [O]=OOT_MODULE
Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.15.0-1 04/01/2014
Call Trace:
 <TASK>
 dump_stack_lvl+0x8c/0xd0
 lbug_with_loc+0x33/0x90 [libcfs]
 lu_object_put+0x3f9/0x9f0 [obdclass]
 llog_osd_close+0x14a/0x570 [obdclass]
 llog_close+0xa0/0xe0 [obdclass]
 llog_cat_close+0x109/0x650 [obdclass]
 llog_test_12+0xd19/0x1600 [llog_test]
 llog_run_tests+0x4512/0x5b10 [llog_test]
 ? __llog_ctxt_put+0x19d/0x2c0 [obdclass]
 ? __llog_ctxt_put+0x110/0x2c0 [obdclass]
 llog_test_device_init+0x6ea/0xa20 [llog_test]
 obd_setup+0x506/0x8d0 [obdclass]
 class_setup+0x7c0/0x1080 [obdclass]
 class_process_config+0x2d63/0x7600 [obdclass]
 class_handle_ioctl+0x1f98/0x3380 [obdclass]
 ? cap_capable+0xac/0x2e0
 obd_class_ioctl+0x1f6/0x3c0 [obdclass]
 __x64_sys_ioctl+0x13ca/0x1590
 ? _copy_to_user+0x3d/0x60
 ? fpregs_assert_state_consistent+0x2d/0xa0
 do_syscall_64+0x6c/0x140
 entry_SYSCALL_64_after_hwframe+0x4b/0x53
RIP: 0033:0x7f79014998db
Code: 00 48 89 44 24 18 31 c0 48 8d 44 24 60 c7 04 24 10 00 00 00 48 89 44 24 08 48 8d 44 24 20 48 89 44 24 10 b8 10 00 00 00 0f 05 <89> c2 3d 00 f0 ff ff 77 1c 48 8b 44 24 18 64 48 2b 04 25 28 00 00
RSP: 002b:00007ffdc9533a10 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007ffdc9537068 RCX: 00007f79014998db
RDX: 00007ffdc9533ad0 RSI: 00000000c00866b8 RDI: 0000000000000003
RBP: 00007ffdc9533aa0 R08: 0000000000000000 R09: 00007f7901574b20
R10: 0000000000000070 R11: 0000000000000246 R12: 0000000000000000
R13: 00007ffdc9537078 R14: 00007f790177b000 R15: 00005557339044f0
 </TASK>
Kernel panic - not syncing: LBUG
