LU-18838 llite: fix race conditions in statahead causing NULL pointer crashes

(this was vibecoded with a tiny bit of review, by auggie / opus4.5,
 I am just tryign to see if it will really have a dent before spending
 any more time on it)

Two types of kernel NULL pointer dereference crashes were observed in
 statahead code:

1) In ll_sax_put() at line 582, where lli is NULL when accessing
   &lli->lli_sa_lock. This originates from ll_statahead_thread()
where
   ll_sai_put(sai) is followed by ll_sax_put(dir, lli->lli_sax) using
   potentially stale dir/lli pointers.

2) In sa_alloc() at line 226, where lli is NULL when acquiring
spinlock.
   This is a TOCTOU race: parent->d_inode could become NULL between
the
   check in sa_statahead() and the dereference in sa_alloc().

Root cause: After ll_sai_put() releases the sai (which calls dput()
on
sai_dentry), local variables derived from sai->sai_dentry->d_inode
become
stale. Additionally, re-dereferencing sai->sai_dentry->d_inode in
called
functions can race with inode eviction.

Fix by:
  • Save ctx (statahead context) before ll_sai_put() and use
    ctx->sax_inode
  (which holds its own igrab() reference) for ll_sax_put()
  • Add NULL check for parent->d_inode in sa_statahead()
  • Pass validated lli/dir as parameters to functions instead of
  re-dereferencing sai->sai_dentry->d_inode:
     • sa_alloc(): add lli parameter
     • sa_kill()/sa_kill_try(): add lli parameter
     • sa_make_ready(): add lli parameter
     • ll_agl_add(): add dir parameter
     • ll_statahead_flush_nowait(): add dir parameter
     • sa_put(): use dir parameter for ll_i2sbi()

Change-Id: I2d450f5a73772972aa7fc06b730bd6ee6e232bba
Signed-off-by: Oleg Drokin <green@whamcloud.com>
