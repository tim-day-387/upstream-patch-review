LU-19771 lfsck: lfsck_namespace_assistant_handler_p1 refactor

lfsck_namespace_assistant_handler_p1() is too long and complex,
so split it into smaller chunks.
This was done using auggie agent with Claude Opus 4.5 model

Summary of Refactoring

The function lfsck_namespace_assistant_handler_p1() has been
successfully refactored from a monolithic ~527-line function into a
well-structured implementation using 12 helper functions.

New Components Added

  1. Context Structure (struct lfsck_namespace_p1_ctx):
     • Encapsulates all shared state between helper functions
     • Reduces parameter passing overhead
     • Groups related fields logically (input parameters, cached
       pointers, state, flags)

  2. Helper Functions Created:

| Function | Purpose |
|----------|---------|
| lfsck_namespace_p1_ctx_init() | Initialize context structure |
| lfsck_namespace_p1_ctx_fini() | Clean up resources |
| lfsck_namespace_p1_load_dir() | Lazy-load parent directory object |
| lfsck_namespace_p1_check_dirent_attr() | Handle already-repaired
   dirent attributes |
fsck_namespace_p1_handle_dotdot() | Handle ".." entries with
zero/invalid FID |
| lfsck_namespace_p1_handle_special_dirs() | Handle striped dirs,
dot-sequence FIDs |
| lfsck_namespace_p1_resolve_dev() | Resolve target MDT device for
FID |
| lfsck_namespace_p1_handle_dangling() | Handle dangling name entries
 |
| lfsck_namespace_p1_acquire_lock_trans() | Acquire lock and start
transaction |
| lfsck_namespace_p1_release_lock_trans() | Release lock and stop
transaction |
| lfsck_namespace_p1_verify_linkea() | Verify linkea and determine
repair action |
| lfsck_namespace_p1_repair_linkea() | Perform actual linkea repair |
| lfsck_namespace_p1_handle_bad_hash() | Handle bad name hash for
striped dirs |
| lfsck_namespace_p1_handle_type_repair() | Handle BAD_TYPE and
BAD_DIRENT repairs |
| lfsck_namespace_p1_schedule_p2_check() | Schedule phase 2 linkea
check |
| lfsck_namespace_p1_record_result() | Record results and update
counters |

Key Improvements

  1. Reduced Complexity: Main function reduced from ~527 lines to ~150
     lines
  2. Clear Responsibilities: Each helper has a single, well-defined
     purpose
  3. Preserved Conventions: ENTRY/GOTO/RETURN macros maintained for
     Lustre tracing
  4. Preserved Functionality: All error handling paths and return codes
     preserved
  5. Better Documentation: Each helper has kerneldoc-style comments
  6. Reduced Nesting: Complex nested conditionals extracted into
     separate functions
  7. Improved Maintainability: Easier to understand, debug, and modify
     individual components

Change-Id: I348af10ff5870c0f34a56b7f6ff36470e369e53d
Test-Parameters: trivial testlist=sanity-lfsck
Signed-off-by: Oleg Drokin <green@whamcloud.com>
