LU-19755 osc: fix race in max_rpcs_in_flight check

When multiple ptlrpcd threads process RPCs concurrently, they
can all pass the osc_max_rpc_in_flight() check before any of
them has incremented the in-flight counter. This happens
because the check is done under cl_loi_list_lock but the
counter is incremented later in osc_send_*_rpc() after the
lock is released.

Fix this by adding a cl_pending_in_flight counter that
reserves a slot while still holding the lock. This counter
is included in rpcs_in_flight() so concurrent threads see
the reservation and wait appropriately.

Add OBD_FAIL_OSC_DELAY_RPC to allow testing this fix by
injecting a delay in the race window, and sanity test 55d
to verify the limit is respected under concurrency.

Thanks to Jinshan Xiong of Google for reporting this issue
and suggesting the fix.

Signed-off-by: Patrick Farrell <pfarrell@whamcloud.com>
Change-Id: I8ceacf3d9040d94fc89ab54a39bd98a4fb35ae1d
