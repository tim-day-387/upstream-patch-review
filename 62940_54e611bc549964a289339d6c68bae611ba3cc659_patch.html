<html lang="en">
<body>
<pre>
LU-19648 tests: Add wait_nm_sync in setup_local_client_nodemap

Sanity-sec tests use setup_local_client_nodemap() as a template to add
new nodemaps in a specific admin/trusted combination. The previous
patch removed some nodemap synchronization waits to speed up the test.

However, if nodemaps are already activated, and the default nodemap
were already set to admin and trusted previously, checking for nodemap
synchronization is instant because there was no change to check for in
wait_nm_sync(). This can result in a situation where
setup_local_client_nodemap() is not waiting for deletion of nodemap
$nm_name, which may cause tests like 81a to fail.

This patch re-adds wait_nm_sync() to ensure $nm_name is deleted, and
adds further checks for nodemap_test_{setup,cleanup}().

Test-Parameters: trivial
Test-Parameters: testgroup=review-dne-selinux-ssk-part-2
Test-Parameters: testgroup=review-dne-selinux-ssk-part-2
Test-Parameters: testgroup=review-dne-selinux-ssk-part-2
Test-Parameters: testgroup=review-dne-selinux-ssk-part-2
Test-Parameters: testgroup=review-dne-selinux-ssk-part-2
Fixes: e20cc3d570 ("LU-18569 tests: sanity-sec remove duplicate wait_nm_sync calls")
Signed-off-by: Marc Vef <mvef@whamcloud.com>
Change-Id: Ic87e629ea48fd076e7dbc336391eafb1fb5e323a

</pre>
</body>
</html>
